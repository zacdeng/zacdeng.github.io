

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/meditation.png">
  <link rel="icon" href="/img/meditation.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Zachary Deng">
  <meta name="keywords" content="Zack, blog, ROS, Zachary Deng, Zachary, Deng, 邓志豪">
  
    <meta name="description" content="Software Prototyping (IV) - Set up FirebaseIn this tutorial, I will demonstrate how to set up firebase for creating &amp; reading database and adding authentitation. Read from a databaseIn this step,">
<meta property="og:type" content="article">
<meta property="og:title" content="Software Prototyping (IV) - Set up Firebase">
<meta property="og:url" content="http://example.com/2021/11/03/Software%20Prototyping%20(IV)%20-%20Set%20up%20Firebase/index.html">
<meta property="og:site_name" content="Zachary&#39;s Blog">
<meta property="og:description" content="Software Prototyping (IV) - Set up FirebaseIn this tutorial, I will demonstrate how to set up firebase for creating &amp; reading database and adding authentitation. Read from a databaseIn this step,">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-11-03T20:04:07.000Z">
<meta property="article:modified_time" content="2021-11-20T05:50:54.000Z">
<meta property="article:author" content="Zachary Deng">
<meta property="article:tag" content="firebase">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>Software Prototyping (IV) - Set up Firebase - Zachary&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":60,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
        <img src=https://s2.loli.net/2022/03/30/2XuSz3RLxj6VgY9.png width="40px" style="margin-right: 5px">
        <strong> Zachary Deng&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
          
              <li class="nav-item" id="search-btn">
                  <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
                      &nbsp;<i class="iconfont icon-search"></i>&nbsp;
                  </a>
              </li>
              
          

        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archive
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Category
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tag
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/about/">
                    <i class="iconfont icon-user-fill"></i>
                    About Me
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/resume/">
                    <i class="iconfont icon-addrcard"></i>
                    Resume
                  </a>
                
              </div>
            </li>
          
        

          
              <li class="nav-item" id="color-toggle-btn">
                  <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                              class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
              </li>
          
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/page3.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Software Prototyping (IV) - Set up Firebase"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-11-03 15:04" pubdate>
          November 3, 2021 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          11k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          93 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Software Prototyping (IV) - Set up Firebase</h1>
            
            <div class="markdown-body">
              
              <h1 id="Software-Prototyping-IV-Set-up-Firebase"><a href="#Software-Prototyping-IV-Set-up-Firebase" class="headerlink" title="Software Prototyping (IV) - Set up Firebase"></a>Software Prototyping (IV) - Set up Firebase</h1><p>In this tutorial, I will demonstrate how to set up firebase for creating &amp; reading database and adding authentitation.</p>
<h2 id="Read-from-a-database"><a href="#Read-from-a-database" class="headerlink" title="Read from a database"></a>Read from a database</h2><p>In this step, we add a backend cloud database to our app. Cloud databases make sense, especially when prototyping, because they are easy to use and free for modest amounts of data and network traffic.</p>
<h3 id="Add-a-database-to-your-backend-Firebase-project"><a href="#Add-a-database-to-your-backend-Firebase-project" class="headerlink" title="Add a database to your backend Firebase project"></a>Add a database to your backend Firebase project</h3><p>Go to <a target="_blank" rel="noopener" href="https://console.firebase.google.com/">the Firebase web console</a>. Click on the card for your project. On the left side, click on <strong>Database</strong>. On the right side, where it offers several options, scroll until you see <strong>Realtime Database</strong>. Select that.</p>
<p>When Firebase asks about security, put the database in <strong>Test Mode</strong>. This lets anyone read <em>and write</em> to your data. Firebase only allows this mode for a relatively short period of time. To see your security rules, click on the <strong>Rules</strong> tab. You should see this.</p>
<div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>
  <span class="hljs-attr">&quot;rules&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>
    <span class="hljs-attr">&quot;.read&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;.write&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span>
  <span class="hljs-punctuation">&#125;</span>
<span class="hljs-punctuation">&#125;</span></code></pre></div>

<p>You will change these rules later in <a target="_blank" rel="noopener" href="https://courses.cs.northwestern.edu/394/guides/intro-react.php#add-authentication">the authentication task</a>.</p>
<p>The Realtime Database is simple – the database is just one big JSON object – and supports real-time notifications of changes to the data. Initially it is empty. You can use the console to import a file with some initial JSON data.</p>
<p>On the Firebase web console. click on <strong>Realtime Database</strong> on the left. Click on the <strong>Data</strong> tab. Click on the vertical three-dot menu and select <strong>Import JSON</strong>. Follow the instructions.</p>
<p>Verify that the data successfully imported and you can browse it on the web console.</p>
<h3 id="Add-the-Firebase-package"><a href="#Add-the-Firebase-package" class="headerlink" title="Add the Firebase package"></a>Add the Firebase package</h3><p>You have already installed the Firebase CLI, i.e., <strong>firebase-tools</strong>. To use the database functions in your code, you need to install the Firebase library. To make using Firebase easier in React, also install <strong>react-firebase-hooks</strong>.</p>
<div class="code-wrapper"><pre><code class="hljs shell">npm install firebase react-firebase-hooks</code></pre></div>

<blockquote>
<p>The API for Firebase version 9 is quite different than Firebase version 8. The same concepts and code are there, but the way you call the code is different. The reasons and differences ar summarized <a target="_blank" rel="noopener" href="https://firebase.google.com/docs/web/learn-more#modular-version">here</a>. Until version 9 is in commonly use, we show code for both versions below.</p>
</blockquote>
<h3 id="Add-code-to-initialize-Firebase"><a href="#Add-code-to-initialize-Firebase" class="headerlink" title="Add code to initialize Firebase"></a>Add code to initialize Firebase</h3><p>To keep the code modular, Firebase initialization should go into a separate file, like <strong>src&#x2F;utilities&#x2F;firebase.js</strong>. The boilerplate for importing Firebase, including the database library, looks like this:</p>
<p><strong>firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> firebase <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;firebase/app&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;firebase/database&#x27;</span>;

<span class="hljs-keyword">const</span> firebaseConfig = &#123;
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">authDomain</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">databaseURL</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">projectId</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">storageBucket</span>: <span class="hljs-string">&quot;....&quot;</span>,
  <span class="hljs-attr">messagingSenderId</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">appId</span>: <span class="hljs-string">&quot;...&quot;</span>
&#125;;

firebase.<span class="hljs-title function_">initializeApp</span>(firebaseConfig);
<span class="hljs-keyword">const</span> database = firebase.<span class="hljs-title function_">database</span>();</code></pre></div>

<p><strong>firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; initializeApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;firebase/app&#x27;</span>;
<span class="hljs-keyword">import</span> &#123; getDatabase, onValue, ref, set &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;firebase/database&#x27;</span>;

<span class="hljs-keyword">const</span> firebaseConfig = &#123;
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">authDomain</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">databaseURL</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">projectId</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">storageBucket</span>: <span class="hljs-string">&quot;....&quot;</span>,
  <span class="hljs-attr">messagingSenderId</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-attr">appId</span>: <span class="hljs-string">&quot;...&quot;</span>
&#125;;

<span class="hljs-keyword">const</span> firebase = <span class="hljs-title function_">initializeApp</span>(firebaseConfig);
<span class="hljs-keyword">const</span> database = <span class="hljs-title function_">getDatabase</span>(firebase);</code></pre></div>

<p>You have to get <strong>firebaseConfig</strong> from <a target="_blank" rel="noopener" href="https://console.firebase.google.com/">the Firebase web console</a>.</p>
<ul>
<li><p>Click on your project.</p>
</li>
<li><p>Click on the “gear” icon in the upper left and select <strong>Project settings</strong>.</p>
</li>
<li><p>Click on the <strong>General</strong> tab.</p>
</li>
<li><p>Scroll down to the <strong>Your apps</strong> section, and click on the web app you registered for this project.</p>
<blockquote>
<p>If you haven’t registered a web app, do so now by clicking <strong>Add app</strong>.</p>
</blockquote>
</li>
<li><p>On the right, click the <strong>config</strong> radio button under <strong>SDK setup and configuration</strong>.</p>
</li>
<li><p>Copy the JavaScript code you see there into <strong>firebase.js</strong> as shown above.</p>
</li>
</ul>
<h3 id="Fetching-data-from-Firebase"><a href="#Fetching-data-from-Firebase" class="headerlink" title="Fetching data from Firebase"></a>Fetching data from Firebase</h3><p>Fetching data from Firebase can be done similarly to how <a target="_blank" rel="noopener" href="https://courses.cs.northwestern.edu/394/guides/intro-react.php#use-effect-fetch">data was fetched using <strong>fetch</strong></a>, using <strong>useState</strong> and <strong>useEffect</strong>. There are several important differences.</p>
<ul>
<li>You access the data with a <em>database reference</em> not a URL.</li>
<li>You don’t get data directly. Instead, you <em>subscribe</em> to the database, by giving Firebase a function to call when the data changes. That function normally will update a state variable.</li>
</ul>
<p>A database reference is like a URL, but refers to some part of the JSON data stored in your realtime database. A reference (but no actual data) is created with</p>
<p><strong>firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js">database.<span class="hljs-title function_">ref</span>(path)</code></pre></div>

<p><strong>firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">ref</span>(database, path)</code></pre></div>

<p>where <strong>firebase</strong> is the variable holding your Firebase object, and <em>path</em> refers to some part of your JSON object. For example, in the following references</p>
<p><strong>firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js">database.<span class="hljs-title function_">ref</span>()
database.<span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;/&#x27;</span>)
database.<span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;/courses&#x27;</span>)</code></pre></div>

<p><strong>firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">ref</span>(database)
<span class="hljs-title function_">ref</span>(database, <span class="hljs-string">&#x27;/&#x27;</span>)
<span class="hljs-title function_">ref</span>(database, <span class="hljs-string">&#x27;/courses&#x27;</span>)</code></pre></div>

<p>the first two refer to the entire JSON, and the last refers to the data stored under the key <strong>courses</strong>.</p>
<p><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/reference/node/firebase.database.Reference">More about Firebase database references.</a></p>
<p>In Firebase, you normally <em>subscribe</em> to a database. That means you pass Firebase a function to be called every time the data at the end of some path changes. The function will be sent a <em>snapshot</em> object. The <strong>val()</strong> method of this object will contain the new data.</p>
<p>In React, the appropriate thing to do when Firebase sends new data is to store it in a React state variable. Then normal React processing will be triggered to update your page appropriately.</p>
<p>Getting data usually involves three state variables: <strong>data</strong>, <strong>loading</strong>, and <strong>error</strong>. (You can call them anything you want.) Your app code should be written to handle the following cases:</p>
<ul>
<li><strong>error</strong> is defined: Something went wrong and your app should signal a problem. Initially <strong>error</strong> is undefined.</li>
<li><strong>loading</strong> is true: No data is available yet. Your app should indicate that data is being loaded. Initially <strong>loading</strong> is true.</li>
<li>Neither of the above is true. Your app should display what’s in <strong>data</strong>.</li>
</ul>
<p>There’s a bit of boilerplate needed to get data and manage these failures. It makes sense to create a <a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-custom.html">a custom hook</a>. The version here is a more basic version of the <strong>useObjectVal</strong> hook defined in <a target="_blank" rel="noopener" href="https://github.com/CSFrequency/react-firebase-hooks/tree/master/database#useobjectval">react-firebase-hooks</a>. It takes a function as an optional second parameter. If given, the function will be applied to the JSON fetched from Firebase. Whatever <em>function</em> returns will be returned in <strong>data</strong>. This is handy for calling <strong>addScheduleTimes</strong>.</p>
<h2 id="Add-authentitation"><a href="#Add-authentitation" class="headerlink" title="Add authentitation"></a>Add authentitation</h2><p>Authentication has been held off until now. It is a common mistake when developing a new app is to start with sign up or log in. That’s misplaced effort. Signing up is not an interesting thing to user test. Start with the part of your app that is new and different.</p>
<p>But now that user can change the course schedule, it makes sense to only let logged in users make changes. This is called <em>authentication</em>. After authentication comes <em>authorization</em> – can this user do this action – but we’ll only do authentication here. With hooks, Firebase, and a helper UI library, it is not too much code.</p>
<h3 id="Require-authentication-to-change-data"><a href="#Require-authentication-to-change-data" class="headerlink" title="Require authentication to change data"></a>Require authentication to change data</h3><p>A series of small steps is needed to require authentication for writing to the database.</p>
<ul>
<li>Go to <a target="_blank" rel="noopener" href="https://console.firebase.google.com/project/">the Firebase console</a>.</li>
<li>Click on your project.</li>
<li>Click the <strong>Rules</strong> tab.</li>
<li>Click the button <strong>Edit rules</strong>.</li>
</ul>
<p>Your rules should currently look like this:</p>
<div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>
  <span class="hljs-attr">&quot;rules&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>
    <span class="hljs-attr">&quot;.read&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;.write&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span>
  <span class="hljs-punctuation">&#125;</span>
<span class="hljs-punctuation">&#125;</span></code></pre></div>

<p>Select the <strong>true</strong> value to the right of <strong>“.write”</strong>. Replace it with the string <code>&quot;auth.uid != null&quot;</code>, so that your rules now look like this:</p>
<div class="code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>
  <span class="hljs-attr">&quot;rules&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>
    <span class="hljs-attr">&quot;.read&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;.write&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;auth.uid != null&quot;</span>
  <span class="hljs-punctuation">&#125;</span>
<span class="hljs-punctuation">&#125;</span></code></pre></div>

<p>Click <strong>Publish</strong> to save the rules.</p>
<p>The new rule is a JavaScript string that Firebase will evaluate when an attempt is made to write data to any part of the database. The variable <strong>auth</strong> will be set to a user object, and <strong>auth.uid</strong> will only have a value if the user has logged in.</p>
<p>Test! Reload your web app page. You should still see the courses. Now try to change a course’s meeting time. You should get a permission denied error. If so, you have now protected your database from guest users.</p>
<h3 id="Enable-authentication-support-on-Firebase"><a href="#Enable-authentication-support-on-Firebase" class="headerlink" title="Enable authentication support on Firebase"></a>Enable authentication support on Firebase</h3><p>Authentication means asking a user to identify themselves, usually with a name or email address and a password. Developers used to write code to do this for every app, but a popular alternative now is to let a third-party service, like Google or Facebook, do the work. Those services manage the database of user information, check passwords, provide “forgot password” emails, and so on. Developers like doing less work. Users like having one less password to remember.</p>
<p>Here’s how to enable authentication with Google, i.e., that users can click on a button and sign in with Google.</p>
<ul>
<li>Go to Firebase console.</li>
<li>Go to your project page.</li>
<li>Click <strong>Authentication</strong> on the left.</li>
<li>Click the <strong>Sign-in method</strong> tab along the top.</li>
<li>Click the <strong>Google</strong> line.</li>
<li>In the panel that opens up, click <strong>Enable</strong> and enter any required information.</li>
<li>Click <strong>Save</strong>.</li>
</ul>
<p>That last step is easy to miss on the Firebase web site!</p>
<p>There are many other options you can enable. Click on them to see what they do. To use a third-party like Facebook or Twitter, you will need to set up a developer account with that service and get an ID for your app.</p>
<h3 id="Add-authentication-code-to-the-app"><a href="#Add-authentication-code-to-the-app" class="headerlink" title="Add authentication code to the app"></a>Add authentication code to the app</h3><p>Now that Google authentication is enabled on the backend, we need to add code on the frontend to let users click a button and log in. The Firebase <strong>auth</strong> object provides a class <strong>GoogleAuthProvider</strong> to do this, as well as a <strong>signOut</strong> method to log out.</p>
<p>In <strong>src&#x2F;utilities&#x2F;firebase.js</strong> add this import</p>
<p><strong>Firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;firebase/auth&#x27;</span>;</code></pre></div>

<p><strong>Firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; getAuth, <span class="hljs-title class_">GoogleAuthProvider</span>, onIdTokenChanged, signInWithPopup, signOut &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;firebase/auth&#x27;</span>;</code></pre></div>

<p>Define and export this function:</p>
<p><strong>Firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">signInWithGoogle</span> = (<span class="hljs-params"></span>) =&gt; &#123;
  <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> firebase.<span class="hljs-property">auth</span>.<span class="hljs-title class_">GoogleAuthProvider</span>();
  firebase.<span class="hljs-title function_">auth</span>().<span class="hljs-title function_">signInWithPopup</span>(provider);
&#125;</code></pre></div>

<p><strong>Firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">signInWithGoogle</span> = (<span class="hljs-params"></span>) =&gt; &#123;
  <span class="hljs-title function_">signInWithPopup</span>(<span class="hljs-title function_">getAuth</span>(firebase), <span class="hljs-keyword">new</span> <span class="hljs-title class_">GoogleAuthProvider</span>());
&#125;;</code></pre></div>

<p>Calling <strong>signInWithGoogle</strong> pops up a dialog box to let the user sign in with Google.</p>
<p>Where should we put the buttons to call these functions? Users will look for this at the top. The term selector seems like a good place. The new button should go to the right, to avoid being accidentally clicked when changing terms.</p>
<p>Bootstrap has many options for laying out a row of buttons. It’s alway best to explore the examples in the documentation and adapt one that looks like what you want. The code below adapts an example from the section on <a target="_blank" rel="noopener" href="https://getbootstrap.com/docs/5.0/components/button-group/#button-toolbar">button toolbars</a>, using a temporary dummy “sign in” button.</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">SignInButton</span> = (<span class="hljs-params"></span>) =&gt; &#123;
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;btn-toolbar justify-content-between&quot;</span>&gt;</span></span>
<span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;btn btn-secondary btn-sm&quot;</span></span></span>
<span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> signInWithGoogle()&#125;&gt;</span>
<span class="language-xml">        Sign In</span>
<span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
<span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
&#125;</code></pre></div>

<p>Test! Believe it or not, you should now have working authentication. Try changing a course meeting time without signing in. Verify that you get the permission denied error. Now click <strong>Sign In</strong>. A dialog box should appear instructing you to sign in with Google. After signing in, trying change a course time again. Now it should work!</p>
<h3 id="Add-signing-out"><a href="#Add-signing-out" class="headerlink" title="Add signing out"></a>Add signing out</h3><p>It’s always good to include a sign out option, so that if someone is using your web app on a public terminal, they can log out.</p>
<p><strong>firebase.auth</strong> provides a simple function for signing out. Define and export this function in <strong>src&#x2F;utilities&#x2F;firebase.js</strong></p>
<p><strong>Firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">signOut</span> = (<span class="hljs-params"></span>) =&gt; firebase.<span class="hljs-title function_">auth</span>().<span class="hljs-title function_">signOut</span>();</code></pre></div>

<p><strong>Firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">firebaseSignOut</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-title function_">signOut</span>(<span class="hljs-title function_">getAuth</span>(firebase));

<span class="hljs-keyword">export</span> &#123; firebaseSignOut <span class="hljs-keyword">as</span> signOut &#125;;</code></pre></div>

<p>Calling <strong>signOut</strong> just logs the user out of Google. No dialog box appears.</p>
<p>Import <strong>signOut</strong> and define a <strong>SignOutButton</strong> to go with your <strong>SignInButton</strong>.</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">SignOuButton</span> = (<span class="hljs-params"></span>) =&gt; (
  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;btn btn-secondary btn-sm&quot;</span></span></span>
<span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> signOut()&#125;&gt;</span>
<span class="language-xml">    Sign Out</span>
<span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
);</code></pre></div>

<p>Signing out is something that can only happen after you have signed in. So it makes sense to show a sign in button only when there is no user signed in, and a sign out button only when there is a user signed in.</p>
<p>Authentication changes are asynchronous, like database changes. You have to listen for a change in user status. In <strong>src&#x2F;utilities&#x2F;firebase.js</strong> define and export a very simple hook to list for changes in user state.</p>
<p><strong>Firebase v8:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useUserState</span> = (<span class="hljs-params"></span>) =&gt; &#123;
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>();

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;
    firebase.<span class="hljs-property">auth</span>.<span class="hljs-title function_">onAuthStateChanged</span>(setUser);
  &#125;, []);

  <span class="hljs-keyword">return</span> [user];
&#125;;</code></pre></div>

<p><strong>Firebase v9:</strong></p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useUserState</span> = (<span class="hljs-params"></span>) =&gt; &#123;
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>();

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;
    <span class="hljs-title function_">onIdTokenChanged</span>(<span class="hljs-title function_">getAuth</span>(firebase), setUser);
  &#125;, []);

  <span class="hljs-keyword">return</span> [user];
&#125;;</code></pre></div>

<p>Now we can show different depends on the user state:</p>
<div class="code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">Display</span> = (<span class="hljs-params"></span>) =&gt; &#123;
	<span class="hljs-keyword">const</span> [user] = <span class="hljs-title function_">useUserState</span>();
	
	<span class="hljs-keyword">return</span> (
		<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;ButtonOnState&quot;</span>&gt;</span></span>
<span class="language-xml">			&#123; user ? <span class="hljs-tag">&lt;<span class="hljs-name">SignOutButton</span> /&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">SignInButton</span> /&gt;</span> &#125;</span>
<span class="language-xml">		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
	)
&#125;</code></pre></div>


              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Software-Prototyping/" class="category-chain-item">Software Prototyping</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/firebase/">#firebase</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Software Prototyping (IV) - Set up Firebase</div>
      <div>http://example.com/2021/11/03/Software Prototyping (IV) - Set up Firebase/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Zachary Deng</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>November 3, 2021</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>Licensed under</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/11/08/Software%20Prototyping%20(%E2%85%A4)%20-%20Cypress%20Usage%20for%20Beginner/" title="Software Prototyping (Ⅴ) - Cypress Usage for Beginner">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Software Prototyping (Ⅴ) - Cypress Usage for Beginner</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/11/01/Software%20Prototyping%20(II)%20-%20React%20&amp;%20Firebase%20start%20code/" title="Software Prototyping (II) - React &amp; Firebase start code">
                        <span class="hidden-mobile">Software Prototyping (II) - React &amp; Firebase start code</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
    <div>
        <word style=font-size:13px>
            Copyright © 2020-2021 <a href="http://zacdeng.github.io" target="_blank"><span style="color:rgb(28, 174, 240);">zacdeng </span></a>
            | Powered by <a href="https://github.com/hexojs/hexo" target="_blank"><span style="color:rgb(28, 174, 240);">Hexo</span></a>
            | Theme <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank"><span style="color:rgb(28, 174, 240);">Fluid</span></a>
        </word>

        <br>

        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span style=font-size:13px>
        <img src="https://i.loli.net/2020/07/19/UPEGCM1z2tgeWsI.png" srcset="/img/loading.gif" lazyload width="20px"> <span id="busuanzi_value_site_pv"></span> |
      </span>

        <span style=font-size:13px>
        <img src="https://i.loli.net/2020/07/19/T8hEs9tzj5acZpF.png" srcset="/img/loading.gif" lazyload width="20px"> <span id="busuanzi_value_site_uv"></span>
      </span>

        <br>

        <span id="timeDate" style=font-size:13px>载入天数...</span>
        <span id="times" style=font-size:13px>载入时分秒...</span>
        <script>
          var now = new Date();
          function createtime(){
            var grt= new Date("07/19/2020 00:00:00");//此处修改你的建站时间或者网站上线时间
            now.setTime(now.getTime()+250);
            days = (now - grt ) / 1000 / 60 / 60 / 24;
            dnum = Math.floor(days);
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
            hnum = Math.floor(hours);
            if(String(hnum).length ==1 ){
              hnum = "0" + hnum;
            }
            minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
            mnum = Math.floor(minutes);
            if(String(mnum).length ==1 ){
              mnum = "0" + mnum;
            }
            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
            snum = Math.round(seconds);
            if(String(snum).length ==1 ){
              snum = "0" + snum;
            }
            document.getElementById("timeDate").innerHTML = "本站安全运行&nbsp"+dnum+"&nbsp天";
            document.getElementById("times").innerHTML = hnum + "&nbsp小时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
          }
          setInterval("createtime()",250);
        </script>
    </div>

  
</div>



  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>






  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
